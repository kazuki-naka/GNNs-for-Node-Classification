pre-train
pre-train
train memory : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::empty         0.85%      17.964ms         0.85%      17.964ms       1.584us       0.000us         0.00%       0.000us       0.000us     157.53 Mb     157.53 Mb       3.72 Gb       3.72 Gb         11343            --  
                                          aten::nonzero         2.55%      53.705ms        28.25%     595.438ms     270.654us      11.431ms         1.20%      43.931ms      19.969us       8.67 Mb       8.27 Mb      69.43 Mb       5.27 Mb          2200            --  
                                              aten::mul         1.43%      30.064ms         2.06%      43.498ms       7.479us     197.267ms        20.72%     204.252ms      35.119us       3.12 Mb       3.12 Mb      32.16 Gb      29.48 Gb          5816      5644.800  
                                        aten::remainder         0.14%       3.033ms         0.14%       3.033ms      15.090us       0.000us         0.00%       0.000us       0.000us       2.91 Mb       2.91 Mb           0 b           0 b           201            --  
                                      aten::as_strided_         0.02%     425.000us         0.02%     425.000us       0.708us       0.000us         0.00%       0.000us       0.000us     414.53 Kb     414.53 Kb           0 b           0 b           600            --  
                                    aten::empty_strided         0.65%      13.663ms         0.66%      13.820ms       1.619us       0.000us         0.00%      31.000us       0.004us       4.29 Kb       4.29 Kb       5.51 Gb       5.51 Gb          8536            --  
                                    aten::_foreach_add_         0.14%       3.000ms         0.71%      14.950ms      37.375us       5.172ms         0.54%       5.547ms      13.867us         348 b       1.52 Kb           0 b           0 b           400            --  
                                              aten::div         0.60%      12.631ms         0.81%      17.136ms       7.113us       9.527ms         1.00%      12.740ms       5.289us       1.02 Kb       1.02 Kb       1.94 Gb       1.76 Gb          2409            --  
                                             aten::div_         0.07%       1.446ms         0.10%       2.114ms       9.879us     402.000us         0.04%     485.000us       2.266us         568 b         568 b           0 b           0 b           214            --  
                                          aten::dropout         0.03%     637.000us         0.39%       8.247ms       6.872us       0.000us         0.00%      18.727ms      15.606us           0 b           0 b       3.10 Gb    -526.67 Mb          1200            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.107s
Self CUDA time total: 951.939ms

test acc(real data):  0.94
test acc:  0.8487084870848709
value of cmd:  0.4137633740901947


fine-tuning
train(fine-tuning) : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                          aten::nonzero         1.47%      19.758ms        20.20%     270.986ms     270.986us       3.336ms         0.57%      14.700ms      14.700us       1.86 Mb       1.80 Mb      32.28 Mb       3.74 Mb          1000            --  
                                              aten::mul         1.59%      21.278ms         2.22%      29.760ms       6.447us     145.336ms        24.99%     151.867ms      32.900us     687.23 Kb     687.23 Kb      24.17 Gb      24.02 Gb          4616      4986.776  
                                        aten::remainder         0.12%       1.548ms         0.12%       1.548ms       7.551us       0.000us         0.00%       0.000us       0.000us     652.48 Kb     652.48 Kb           0 b           0 b           205            --  
                                      aten::as_strided_         0.03%     407.000us         0.03%     407.000us       0.678us       0.000us         0.00%       0.000us       0.000us      66.77 Kb      66.77 Kb           0 b           0 b           600            --  
                                               [memory]         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us       3.08 Kb       3.08 Kb     -13.59 Gb     -13.59 Gb         11367            --  
                                    aten::empty_strided         0.50%       6.684ms         0.51%       6.832ms       1.550us       0.000us         0.00%       0.000us       0.000us       2.32 Kb       2.32 Kb       3.52 Gb       3.52 Gb          4408            --  
                                              aten::div         0.70%       9.385ms         0.96%      12.905ms       6.427us       8.688ms         1.49%      11.544ms       5.749us       1.24 Kb       1.24 Kb       1.72 Gb       1.65 Gb          2008            --  
                                             aten::div_         0.10%       1.278ms         0.14%       1.901ms       9.009us     401.000us         0.07%     656.000us       3.109us         496 b         496 b           0 b           0 b           211            --  
                                            aten::empty         0.74%       9.984ms         0.75%      10.052ms       1.435us       0.000us         0.00%       8.000us       0.001us           8 b           8 b       2.43 Gb       2.43 Gb          7004            --  
                                          aten::dropout         0.04%     508.000us         0.44%       5.880ms       9.800us       0.000us         0.00%      19.152ms      31.920us           0 b           0 b       3.02 Gb    -598.28 Mb           600            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.341s
Self CUDA time total: 581.643ms

test(fine-tuning) : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total KFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::copy_         0.93%      23.000us         1.97%      49.000us       8.167us       7.000us         0.46%       7.000us       1.167us      17.98 Kb      17.98 Kb           0 b           0 b             6            --  
                                          aten::nonzero         5.04%     125.000us        37.03%     919.000us     153.167us      32.000us         2.12%      32.000us       5.333us       6.34 Kb       6.34 Kb     173.00 Kb       4.00 Kb             6            --  
                                           aten::matmul         2.38%      59.000us        18.25%     453.000us      75.500us       0.000us         0.00%      40.000us       6.667us           0 b           0 b      13.47 Mb       5.29 Mb             6            --  
                                               aten::mm        14.95%     371.000us        17.45%     433.000us      72.167us     503.000us        33.29%     503.000us      83.833us           0 b           0 b      13.47 Mb      13.47 Mb             6   4040294.400  
cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFla...         0.32%       8.000us         0.32%       8.000us       0.667us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            12            --  
                                       cudaLaunchKernel        11.32%     281.000us        11.32%     281.000us       2.838us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            99            --  
                                               [memory]         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -106.50 Mb    -106.50 Mb            86            --  
                                             aten::add_         0.56%      14.000us         1.25%      31.000us      15.500us      25.000us         1.65%      25.000us      12.500us           0 b           0 b           0 b           0 b             2            --  
                aten::_has_compatible_shallow_copy_type         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             4            --  
                                 ampere_sgemm_128x32_nn         0.00%       0.000us         0.00%       0.000us       0.000us      23.000us         1.52%      23.000us      11.500us           0 b           0 b           0 b           0 b             2            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.482ms
Self CUDA time total: 1.511ms

test acc:  0.9113300492610837


pre-train
train memory : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::empty         0.87%      18.734ms         0.87%      18.734ms       1.645us       0.000us         0.00%       0.000us       0.000us     171.49 Mb     171.49 Mb       3.72 Gb       3.72 Gb         11386            --  
                                          aten::nonzero         2.38%      51.210ms        29.39%     632.035ms     287.289us      11.315ms         1.18%      44.165ms      20.075us       8.67 Mb       8.34 Mb      69.47 Mb       9.57 Mb          2200            --  
                                              aten::mul         1.37%      29.463ms         1.93%      41.591ms       7.156us     209.248ms        21.76%     219.614ms      37.786us       3.07 Mb       3.07 Mb      32.18 Gb      31.05 Gb          5812      5644.792  
                                        aten::remainder         0.14%       3.069ms         0.14%       3.069ms      15.118us       0.000us         0.00%       0.000us       0.000us       2.94 Mb       2.94 Mb           0 b           0 b           203            --  
                                      aten::as_strided_         0.02%     430.000us         0.02%     430.000us       0.717us       0.000us         0.00%       0.000us       0.000us     340.51 Kb     340.51 Kb           0 b           0 b           600            --  
                                    aten::empty_strided         0.61%      13.097ms         0.62%      13.244ms       1.540us       0.000us         0.00%      36.000us       0.004us       4.48 Kb       4.48 Kb       5.45 Gb       5.45 Gb          8600            --  
                                              aten::div         0.53%      11.473ms         0.74%      16.002ms       6.651us       9.499ms         0.99%      14.638ms       6.084us         912 b         912 b       1.92 Gb       1.80 Gb          2406            --  
                                             aten::div_         0.07%       1.480ms         0.10%       2.192ms      10.438us     405.000us         0.04%     824.000us       3.924us         464 b         464 b           0 b           0 b           210            --  
                                    aten::_foreach_add_         0.14%       3.034ms         0.66%      14.221ms      35.553us       5.112ms         0.53%       5.357ms      13.393us         460 b         448 b           0 b           0 b           400            --  
                                          aten::dropout         0.04%     835.000us         0.40%       8.650ms       7.208us       0.000us         0.00%      19.253ms      16.044us           0 b           0 b       3.05 Gb    -584.95 Mb          1200            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.151s
Self CUDA time total: 961.671ms

test acc(real data):  0.943
test acc:  0.8892988929889298
value of cmd:  0.4216117560863495


fine-tuning
train(fine-tuning) : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                          aten::nonzero         1.56%      21.198ms        19.36%     262.990ms     262.990us       3.437ms         0.59%      14.862ms      14.862us       1.86 Mb       1.81 Mb      32.28 Mb       3.85 Mb          1000            --  
                                              aten::mul         1.62%      22.066ms         2.28%      30.964ms       6.712us     143.108ms        24.54%     149.676ms      32.447us     677.66 Kb     677.66 Kb      24.18 Gb      24.16 Gb          4613      4986.775  
                                        aten::remainder         0.12%       1.658ms         0.12%       1.658ms       7.971us       0.000us         0.00%       0.000us       0.000us     661.98 Kb     661.98 Kb           0 b           0 b           208            --  
                                      aten::as_strided_         0.03%     417.000us         0.03%     417.000us       0.695us       0.000us         0.00%       0.000us       0.000us      50.88 Kb      50.88 Kb           0 b           0 b           600            --  
                                               [memory]         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us       3.17 Kb       3.17 Kb     -13.56 Gb     -13.56 Gb         11331            --  
                                    aten::empty_strided         0.52%       7.097ms         0.53%       7.239ms       1.642us       0.000us         0.00%       0.000us       0.000us       2.18 Kb       2.18 Kb       3.66 Gb       3.66 Gb          4408            --  
                                              aten::div         0.71%       9.637ms         0.98%      13.290ms       6.615us       8.779ms         1.51%      11.655ms       5.801us         984 b         984 b       1.72 Gb       1.70 Gb          2009            --  
                                             aten::div_         0.09%       1.266ms         0.14%       1.914ms       9.246us     401.000us         0.07%     657.000us       3.174us         584 b         576 b           0 b           0 b           207            --  
                                    aten::_foreach_add_         0.15%       2.027ms         0.70%       9.545ms      23.863us       1.051ms         0.18%       1.309ms       3.272us         572 b          36 b           0 b           0 b           400            --  
                                            aten::empty         0.76%      10.338ms         0.77%      10.408ms       1.486us       0.000us         0.00%       8.000us       0.001us           8 b           8 b       2.41 Gb       2.41 Gb          7004            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.358s
Self CUDA time total: 583.241ms

test(fine-tuning) : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total KFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::copy_         1.38%      34.000us         2.24%      55.000us       9.167us       7.000us         0.46%       7.000us       1.167us      21.16 Kb      21.16 Kb           0 b           0 b             6            --  
                                          aten::nonzero         5.08%     125.000us        37.36%     919.000us     153.167us      33.000us         2.17%      33.000us       5.500us       6.34 Kb       6.34 Kb     173.00 Kb       4.00 Kb             6            --  
                                           aten::matmul         0.85%      21.000us        17.76%     437.000us      72.833us       0.000us         0.00%     504.000us      84.000us           0 b           0 b      13.47 Mb           0 b             6            --  
                                               aten::mm        14.67%     361.000us        16.91%     416.000us      69.333us     504.000us        33.14%     504.000us      84.000us           0 b           0 b      13.47 Mb      13.47 Mb             6   4040294.400  
cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFla...         0.24%       6.000us         0.24%       6.000us       0.500us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            12            --  
                                       cudaLaunchKernel        10.93%     269.000us        10.93%     269.000us       2.717us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            99            --  
                                               [memory]         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -106.49 Mb    -106.49 Mb            84            --  
                                             aten::add_         0.45%      11.000us         0.69%      17.000us       8.500us      25.000us         1.64%      25.000us      12.500us           0 b           0 b           0 b           0 b             2            --  
                aten::_has_compatible_shallow_copy_type         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             4            --  
                                 ampere_sgemm_128x32_nn         0.00%       0.000us         0.00%       0.000us       0.000us      23.000us         1.51%      23.000us      11.500us           0 b           0 b           0 b           0 b             2            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.460ms
Self CUDA time total: 1.521ms

test acc:  0.9285714285714286


pre-train
train memory : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::empty         0.79%      16.196ms         0.79%      16.196ms       1.421us       0.000us         0.00%       0.000us       0.000us     152.08 Mb     152.08 Mb       3.68 Gb       3.68 Gb         11399            --  
                                          aten::nonzero         2.51%      51.702ms        29.15%     599.352ms     272.433us      11.287ms         1.19%      40.747ms      18.521us       8.67 Mb       8.23 Mb      69.47 Mb      13.19 Mb          2200            --  
                                              aten::mul         1.46%      30.098ms         2.02%      41.608ms       7.155us     200.853ms        21.12%     208.350ms      35.830us       3.11 Mb       3.11 Mb      32.15 Gb      31.75 Gb          5815      5644.798  
                                        aten::remainder         0.14%       2.936ms         0.14%       2.936ms      14.535us       0.000us         0.00%       0.000us       0.000us       2.92 Mb       2.92 Mb           0 b           0 b           202            --  
                                      aten::as_strided_         0.02%     440.000us         0.02%     440.000us       0.733us       0.000us         0.00%       0.000us       0.000us     458.95 Kb     458.95 Kb           0 b           0 b           600            --  
                                    aten::empty_strided         0.66%      13.570ms         0.67%      13.710ms       1.593us       0.000us         0.00%      30.000us       0.003us       4.43 Kb       4.43 Kb       5.39 Gb       5.39 Gb          8608            --  
                                              aten::div         0.54%      11.152ms         0.75%      15.441ms       6.423us       9.479ms         1.00%      12.548ms       5.220us       1.05 Kb       1.05 Kb       1.91 Gb       1.85 Gb          2404            --  
                                    aten::_foreach_add_         0.13%       2.736ms         0.65%      13.350ms      33.375us       5.060ms         0.53%       5.519ms      13.797us         524 b         944 b           0 b           0 b           400            --  
                                             aten::div_         0.07%       1.480ms         0.11%       2.170ms      10.000us     400.000us         0.04%     589.000us       2.714us         576 b         576 b           0 b           0 b           217            --  
                                          aten::dropout         0.04%     781.000us         0.41%       8.443ms       7.036us       0.000us         0.00%      19.136ms      15.947us           0 b           0 b       3.07 Gb    -567.13 Mb          1200            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.056s
Self CUDA time total: 951.111ms

test acc(real data):  0.955
test acc:  0.8708487084870848
value of cmd:  0.4114459156990051


fine-tuning
train(fine-tuning) : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                          aten::nonzero         1.50%      19.959ms        20.38%     271.969ms     271.969us       3.443ms         0.59%      14.912ms      14.912us       1.86 Mb       1.79 Mb      32.29 Mb       3.69 Mb          1000            --  
                                              aten::mul         1.57%      20.986ms         2.20%      29.419ms       6.354us     142.940ms        24.56%     149.444ms      32.277us     731.88 Kb     731.88 Kb      24.18 Gb      23.74 Gb          4630      4986.782  
                                        aten::remainder         0.11%       1.530ms         0.11%       1.530ms       7.612us       0.000us         0.00%       0.000us       0.000us     639.72 Kb     639.72 Kb           0 b           0 b           201            --  
                                      aten::as_strided_         0.03%     401.000us         0.03%     401.000us       0.668us       0.000us         0.00%       0.000us       0.000us      79.49 Kb      79.49 Kb           0 b           0 b           600            --  
                                               [memory]         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us       3.10 Kb       3.10 Kb     -13.50 Gb     -13.50 Gb         11334            --  
                                    aten::empty_strided         0.50%       6.614ms         0.51%       6.763ms       1.534us       0.000us         0.00%       0.000us       0.000us       2.25 Kb       2.25 Kb       3.57 Gb       3.57 Gb          4408            --  
                                              aten::div         0.69%       9.276ms         0.96%      12.749ms       6.343us       8.745ms         1.50%      11.648ms       5.795us       1.07 Kb       1.05 Kb       1.71 Gb       1.63 Gb          2010            --  
                                             aten::div_         0.10%       1.310ms         0.14%       1.923ms       9.114us     404.000us         0.07%     658.000us       3.118us         528 b         528 b           0 b           0 b           211            --  
                                            aten::empty         0.72%       9.676ms         0.73%       9.747ms       1.392us       0.000us         0.00%       8.000us       0.001us          12 b          12 b       2.34 Gb       2.34 Gb          7004            --  
                                          aten::dropout         0.04%     516.000us         0.43%       5.687ms       9.478us       0.000us         0.00%      19.061ms      31.768us           0 b           0 b       3.03 Gb    -605.85 Mb           600            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.335s
Self CUDA time total: 582.112ms

test(fine-tuning) : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total KFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                    aten::empty_strided         0.28%       7.000us         0.28%       7.000us       1.750us       0.000us         0.00%       0.000us       0.000us      21.16 Kb      21.16 Kb       7.00 Kb       7.00 Kb             4            --  
                                          aten::nonzero         5.00%     123.000us        38.22%     941.000us     156.833us      32.000us         2.13%      32.000us       5.333us       6.34 Kb       3.17 Kb     174.50 Kb      84.00 Kb             6            --  
                                      aten::as_strided_         0.04%       1.000us         0.04%       1.000us       0.500us       0.000us         0.00%       0.000us       0.000us       3.17 Kb       3.17 Kb           0 b           0 b             2            --  
                                           aten::matmul         0.77%      19.000us        18.40%     453.000us      75.500us       0.000us         0.00%     505.000us      84.167us           0 b           0 b      13.47 Mb           0 b             6            --  
                                               aten::mm        15.15%     373.000us        17.63%     434.000us      72.333us     505.000us        33.62%     505.000us      84.167us           0 b           0 b      13.47 Mb      13.47 Mb             6   4040294.400  
cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFla...         0.28%       7.000us         0.28%       7.000us       0.583us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            12            --  
                                       cudaLaunchKernel        11.01%     271.000us        11.01%     271.000us       2.737us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            99            --  
                                               [memory]         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -106.57 Mb    -106.57 Mb            85            --  
                                             aten::add_         0.49%      12.000us         0.69%      17.000us       8.500us      25.000us         1.66%      25.000us      12.500us           0 b           0 b           0 b           0 b             2            --  
                                 ampere_sgemm_128x32_nn         0.00%       0.000us         0.00%       0.000us       0.000us      23.000us         1.53%      23.000us      11.500us           0 b           0 b           0 b           0 b             2            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.462ms
Self CUDA time total: 1.502ms

test acc:  0.9211822660098522


pre-train
train memory : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::empty         0.77%      16.699ms         0.77%      16.699ms       1.459us       0.000us         0.00%       0.000us       0.000us     177.30 Mb     177.30 Mb       3.73 Gb       3.73 Gb         11449            --  
                                          aten::nonzero         2.39%      51.427ms        29.14%     627.999ms     285.454us      11.319ms         1.18%      50.799ms      23.090us       8.67 Mb       8.27 Mb      69.48 Mb      12.96 Mb          2200            --  
                                              aten::mul         1.43%      30.792ms         1.99%      42.984ms       7.389us     197.443ms        20.65%     205.150ms      35.267us       3.14 Mb       3.14 Mb      32.16 Gb      32.01 Gb          5817      5644.802  
                                        aten::remainder         0.14%       2.951ms         0.14%       2.951ms      14.682us       0.000us         0.00%       0.000us       0.000us       2.91 Mb       2.91 Mb           0 b           0 b           201            --  
                                      aten::as_strided_         0.02%     415.000us         0.02%     415.000us       0.692us       0.000us         0.00%       0.000us       0.000us     414.53 Kb     414.53 Kb           0 b           0 b           600            --  
                                    aten::empty_strided         0.61%      13.161ms         0.62%      13.305ms       1.531us       0.000us         0.00%      31.000us       0.004us       4.33 Kb       4.33 Kb       5.46 Gb       5.46 Gb          8688            --  
                                    aten::_foreach_add_         0.14%       3.031ms         0.64%      13.873ms      34.682us       5.090ms         0.53%       5.263ms      13.158us         468 b       1.12 Kb           0 b           0 b           400            --  
                                              aten::div         0.58%      12.396ms         0.78%      16.759ms       6.974us       9.538ms         1.00%      12.824ms       5.337us        1016 b        1016 b       1.89 Gb       1.81 Gb          2403            --  
                                             aten::div_         0.07%       1.443ms         0.10%       2.147ms      10.273us     402.000us         0.04%       1.266ms       6.057us         640 b         640 b           0 b           0 b           209            --  
                                          aten::dropout         0.04%     771.000us         0.40%       8.523ms       7.103us       0.000us         0.00%      21.509ms      17.924us           0 b           0 b       3.13 Gb    -509.29 Mb          1200            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.155s
Self CUDA time total: 956.110ms

test acc(real data):  0.954
test acc:  0.8868388683886839
value of cmd:  0.2816145718097687


fine-tuning
train(fine-tuning) : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                          aten::nonzero         1.48%      19.820ms        20.43%     273.391ms     273.391us       3.376ms         0.58%      14.779ms      14.779us       1.86 Mb       1.78 Mb      32.29 Mb       4.02 Mb          1000            --  
                                        aten::remainder         0.13%       1.690ms         0.13%       1.690ms       8.086us       0.000us         0.00%       0.000us       0.000us     665.16 Kb     665.16 Kb           0 b           0 b           209            --  
                                              aten::mul         1.59%      21.263ms         2.23%      29.815ms       6.470us     142.839ms        24.64%     149.329ms      32.406us     661.84 Kb     661.84 Kb      24.17 Gb      24.09 Gb          4608      4986.773  
                                      aten::as_strided_         0.03%     406.000us         0.03%     406.000us       0.677us       0.000us         0.00%       0.000us       0.000us      85.85 Kb      85.85 Kb           0 b           0 b           600            --  
                                               [memory]         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us       3.30 Kb       3.30 Kb     -13.55 Gb     -13.55 Gb         11331            --  
                                    aten::empty_strided         0.49%       6.549ms         0.50%       6.686ms       1.517us       0.000us         0.00%       0.000us       0.000us       2.37 Kb       2.37 Kb       3.50 Gb       3.50 Gb          4408            --  
                                              aten::div         0.70%       9.349ms         0.96%      12.791ms       6.345us       8.703ms         1.50%      11.575ms       5.742us       1.03 Kb       1.03 Kb       1.73 Gb       1.68 Gb          2016            --  
                                             aten::div_         0.09%       1.260ms         0.14%       1.881ms       9.087us     400.000us         0.07%     656.000us       3.169us         560 b         560 b           0 b           0 b           207            --  
                                            aten::empty         0.74%       9.904ms         0.75%       9.977ms       1.424us       0.000us         0.00%       8.000us       0.001us           8 b           8 b       2.43 Gb       2.43 Gb          7004            --  
                                          aten::dropout         0.04%     513.000us         0.42%       5.669ms       9.448us       0.000us         0.00%      18.955ms      31.592us           0 b           0 b       3.05 Gb    -564.19 Mb           600            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.338s
Self CUDA time total: 579.639ms

test(fine-tuning) : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total KFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                               aten::to         0.08%       2.000us         2.10%      52.000us      10.400us       0.000us         0.00%       4.000us       0.800us      17.98 Kb      21.16 Kb      10.50 Kb           0 b             5            --  
                                         aten::_to_copy         0.77%      19.000us         1.93%      48.000us      12.000us       0.000us         0.00%       4.000us       1.000us      21.16 Kb      21.16 Kb      10.50 Kb           0 b             4            --  
                                          aten::nonzero         4.76%     118.000us        37.48%     930.000us     155.000us      33.000us         2.19%      33.000us       5.500us       6.34 Kb       6.34 Kb     173.50 Kb      10.50 Kb             6            --  
                                           aten::matmul         0.89%      22.000us        18.34%     455.000us      75.833us       0.000us         0.00%     503.000us      83.833us           0 b           0 b      13.47 Mb           0 b             6            --  
                                               aten::mm        14.99%     372.000us        17.45%     433.000us      72.167us     503.000us        33.40%     503.000us      83.833us           0 b           0 b      13.47 Mb      13.47 Mb             6   4040294.400  
cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFla...         0.32%       8.000us         0.32%       8.000us       0.667us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            12            --  
                                       cudaLaunchKernel        10.92%     271.000us        10.92%     271.000us       2.737us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            99            --  
                                              aten::mul         3.02%      75.000us         4.15%     103.000us      10.300us     257.000us        17.07%     257.000us      25.700us           0 b           0 b      46.19 Mb      46.19 Mb            10      4763.072  
                                             aten::add_         0.48%      12.000us         0.64%      16.000us       8.000us      25.000us         1.66%      25.000us      12.500us           0 b           0 b           0 b           0 b             2            --  
                aten::_has_compatible_shallow_copy_type         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             4            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.481ms
Self CUDA time total: 1.506ms

test acc:  0.9211822660098522


pre-train
train memory : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::empty         0.82%      16.847ms         0.82%      16.847ms       1.483us       0.000us         0.00%       0.000us       0.000us     143.59 Mb     143.59 Mb       3.75 Gb       3.75 Gb         11362            --  
                                          aten::nonzero         2.49%      51.025ms        28.70%     587.847ms     267.203us      11.350ms         1.19%      46.344ms      21.065us       8.67 Mb       8.28 Mb      69.42 Mb      14.71 Mb          2200            --  
                                              aten::mul         1.50%      30.744ms         2.09%      42.868ms       7.377us     197.712ms        20.68%     204.684ms      35.224us       3.05 Mb       3.05 Mb      32.15 Gb      32.15 Gb          5811      5644.790  
                                        aten::remainder         0.14%       2.935ms         0.14%       2.935ms      14.458us       0.000us         0.00%       0.000us       0.000us       2.94 Mb       2.94 Mb           0 b           0 b           203            --  
                                      aten::as_strided_         0.02%     422.000us         0.02%     422.000us       0.703us       0.000us         0.00%       0.000us       0.000us     399.73 Kb     399.73 Kb           0 b           0 b           600            --  
                                    aten::empty_strided         0.64%      13.100ms         0.65%      13.243ms       1.547us       0.000us         0.00%      30.000us       0.004us       4.34 Kb       4.34 Kb       5.38 Gb       5.38 Gb          8560            --  
                                              aten::div         0.57%      11.636ms         0.79%      16.137ms       6.704us       9.527ms         1.00%      11.468ms       4.764us         976 b         960 b       1.91 Gb       1.89 Gb          2407            --  
                                    aten::_foreach_add_         0.16%       3.344ms         0.69%      14.129ms      35.322us       5.055ms         0.53%       5.221ms      13.053us         444 b         768 b           0 b           0 b           400            --  
                                             aten::div_         0.07%       1.451ms         0.11%       2.176ms       9.982us     400.000us         0.04%     756.000us       3.468us         672 b         672 b           0 b           0 b           218            --  
                                          aten::dropout         0.04%     918.000us         0.44%       8.964ms       7.470us       0.000us         0.00%      18.834ms      15.695us           0 b           0 b       3.06 Gb    -575.31 Mb          1200            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.048s
Self CUDA time total: 955.986ms

test acc(real data):  0.953
test acc:  0.8720787207872078
value of cmd:  0.25266069173812866


fine-tuning
train(fine-tuning) : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                          aten::nonzero         1.47%      19.419ms        20.66%     272.400ms     272.400us       3.436ms         0.59%      14.822ms      14.822us       1.86 Mb       1.78 Mb      32.28 Mb       4.19 Mb          1000            --  
                                              aten::mul         1.60%      21.067ms         2.21%      29.176ms       6.322us     144.283ms        24.83%     150.293ms      32.566us     684.07 Kb     684.07 Kb      24.21 Gb      24.21 Gb          4615      4986.776  
                                        aten::remainder         0.10%       1.380ms         0.10%       1.380ms       6.732us       0.000us         0.00%       0.000us       0.000us     652.41 Kb     652.41 Kb           0 b           0 b           205            --  
                                      aten::as_strided_         0.03%     406.000us         0.03%     406.000us       0.677us       0.000us         0.00%       0.000us       0.000us      82.67 Kb      82.67 Kb           0 b           0 b           600            --  
                                               [memory]         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us       3.09 Kb       3.09 Kb     -13.71 Gb     -13.71 Gb         11389            --  
                                    aten::empty_strided         0.51%       6.748ms         0.52%       6.892ms       1.564us       0.000us         0.00%       0.000us       0.000us       2.22 Kb       2.22 Kb       3.67 Gb       3.67 Gb          4408            --  
                                              aten::div         0.68%       8.970ms         0.95%      12.526ms       6.204us       8.736ms         1.50%      11.621ms       5.756us         880 b         880 b       1.73 Gb       1.69 Gb          2019            --  
                                             aten::div_         0.09%       1.143ms         0.13%       1.706ms       7.972us     400.000us         0.07%     657.000us       3.070us         624 b         624 b           0 b           0 b           214            --  
                                            aten::empty         0.72%       9.434ms         0.72%       9.504ms       1.357us       0.000us         0.00%       8.000us       0.001us          12 b          12 b       2.34 Gb       2.34 Gb          7004            --  
                                          aten::dropout         0.04%     548.000us         0.44%       5.780ms       9.633us       0.000us         0.00%      19.021ms      31.702us           0 b           0 b       3.07 Gb    -541.47 Mb           600            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.319s
Self CUDA time total: 581.077ms

test(fine-tuning) : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total KFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                    aten::empty_strided         0.36%       9.000us         0.36%       9.000us       2.250us       0.000us         0.00%       0.000us       0.000us      21.16 Kb      21.16 Kb      10.50 Kb      10.50 Kb             4            --  
                                          aten::nonzero         4.93%     123.000us        37.06%     924.000us     154.000us      32.000us         2.12%      32.000us       5.333us       6.34 Kb       6.34 Kb     173.50 Kb      83.00 Kb             6            --  
                                           aten::matmul         0.92%      23.000us        18.81%     469.000us      78.167us       0.000us         0.00%     504.000us      84.000us           0 b           0 b      13.47 Mb           0 b             6            --  
                                               aten::mm        15.52%     387.000us        17.89%     446.000us      74.333us     504.000us        33.36%     504.000us      84.000us           0 b           0 b      13.47 Mb      13.47 Mb             6   4040294.400  
cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFla...         0.24%       6.000us         0.24%       6.000us       0.500us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            12            --  
                                       cudaLaunchKernel        10.71%     267.000us        10.71%     267.000us       2.697us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            99            --  
                                              aten::mul         2.89%      72.000us         4.09%     102.000us      10.200us     262.000us        17.34%     262.000us      26.200us           0 b           0 b      46.19 Mb      46.19 Mb            10      4763.072  
                                             aten::add_         0.48%      12.000us         0.64%      16.000us       8.000us      25.000us         1.65%      25.000us      12.500us           0 b           0 b           0 b           0 b             2            --  
                                 ampere_sgemm_128x32_nn         0.00%       0.000us         0.00%       0.000us       0.000us      23.000us         1.52%      23.000us      11.500us           0 b           0 b           0 b           0 b             2            --  
                aten::_has_compatible_shallow_copy_type         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b     -14.00 Kb     -14.00 Kb             4            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.493ms
Self CUDA time total: 1.511ms

test acc:  0.9310344827586207


pre-train
train memory : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::empty         0.84%      17.666ms         0.84%      17.666ms       1.561us       0.000us         0.00%       0.000us       0.000us     132.24 Mb     132.24 Mb       3.79 Gb       3.79 Gb         11319            --  
                                          aten::nonzero         2.46%      51.809ms        29.33%     616.769ms     280.350us      11.294ms         1.18%      40.653ms      18.479us       8.67 Mb       8.33 Mb      69.43 Mb       9.99 Mb          2200            --  
                                              aten::mul         1.42%      29.863ms         2.00%      42.129ms       7.254us     204.377ms        21.28%     213.672ms      36.789us       3.01 Mb       3.01 Mb      32.15 Gb      32.10 Gb          5808      5644.785  
                                        aten::remainder         0.15%       3.063ms         0.15%       3.063ms      14.797us       0.000us         0.00%       0.000us       0.000us       2.99 Mb       2.99 Mb           0 b           0 b           207            --  
                                      aten::as_strided_         0.02%     434.000us         0.02%     434.000us       0.723us       0.000us         0.00%       0.000us       0.000us     355.31 Kb     355.31 Kb           0 b           0 b           600            --  
                                    aten::empty_strided         0.63%      13.201ms         0.63%      13.343ms       1.569us       0.000us         0.00%      31.000us       0.004us       4.21 Kb       4.21 Kb       5.39 Gb       5.39 Gb          8504            --  
                                    aten::_foreach_add_         0.14%       2.897ms         0.66%      13.868ms      34.670us       5.164ms         0.54%       5.222ms      13.055us         448 b       1.64 Kb           0 b           0 b           400            --  
                                              aten::div         0.56%      11.767ms         0.77%      16.284ms       6.765us       9.461ms         0.99%      11.904ms       4.946us         992 b         976 b       1.91 Gb       1.88 Gb          2407            --  
                                             aten::div_         0.07%       1.426ms         0.10%       2.112ms      10.105us     400.000us         0.04%     438.000us       2.096us         648 b         648 b           0 b           0 b           209            --  
                                          aten::dropout         0.03%     680.000us         0.37%       7.872ms       6.560us       0.000us         0.00%      18.885ms      15.738us           0 b           0 b       3.07 Gb    -562.83 Mb          1200            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.103s
Self CUDA time total: 960.399ms

test acc(real data):  0.949
test acc:  0.8696186961869619
value of cmd:  0.38173678517341614


fine-tuning
train(fine-tuning) : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                          aten::nonzero         1.49%      19.791ms        20.16%     267.836ms     267.836us       3.350ms         0.58%      14.665ms      14.665us       1.86 Mb       1.79 Mb      32.28 Mb       3.31 Mb          1000            --  
                                              aten::mul         1.59%      21.121ms         2.23%      29.618ms       6.422us     142.780ms        24.72%     149.224ms      32.356us     674.56 Kb     674.56 Kb      24.20 Gb      24.17 Gb          4612      4986.774  
                                        aten::remainder         0.12%       1.589ms         0.12%       1.589ms       7.751us       0.000us         0.00%       0.000us       0.000us     652.40 Kb     652.40 Kb           0 b           0 b           205            --  
                                      aten::as_strided_         0.03%     402.000us         0.03%     402.000us       0.670us       0.000us         0.00%       0.000us       0.000us      73.13 Kb      73.13 Kb           0 b           0 b           600            --  
                                               [memory]         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us       3.13 Kb       3.13 Kb     -13.50 Gb     -13.50 Gb         11333            --  
                                    aten::empty_strided         0.49%       6.501ms         0.50%       6.648ms       1.508us       0.000us         0.00%       0.000us       0.000us       2.20 Kb       2.20 Kb       3.50 Gb       3.50 Gb          4408            --  
                                              aten::div         0.71%       9.401ms         0.98%      12.951ms       6.402us       8.731ms         1.51%      11.699ms       5.783us       1.13 Kb       1.07 Kb       1.81 Gb       1.74 Gb          2023            --  
                                             aten::div_         0.09%       1.235ms         0.14%       1.841ms       8.725us     401.000us         0.07%     656.000us       3.109us         616 b         616 b           0 b           0 b           211            --  
                                            aten::empty         0.71%       9.480ms         0.72%       9.549ms       1.363us       0.000us         0.00%       8.000us       0.001us          16 b          16 b       2.37 Gb       2.37 Gb          7004            --  
                                          aten::dropout         0.04%     512.000us         0.43%       5.733ms       9.555us       0.000us         0.00%      18.953ms      31.588us           0 b           0 b       3.07 Gb    -567.98 Mb           600            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.328s
Self CUDA time total: 577.658ms

test(fine-tuning) : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total KFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                    aten::empty_strided         0.32%       8.000us         0.32%       8.000us       2.000us       0.000us         0.00%       0.000us       0.000us      21.16 Kb      21.16 Kb      10.50 Kb      10.50 Kb             4            --  
                                            aten::copy_         1.00%      25.000us         1.96%      49.000us       8.167us       7.000us         0.46%       7.000us       1.167us      17.98 Kb      17.98 Kb           0 b           0 b             6            --  
                                          aten::nonzero         4.92%     123.000us        37.76%     944.000us     157.333us      34.000us         2.22%      34.000us       5.667us       6.34 Kb       6.34 Kb     174.00 Kb      82.50 Kb             6            --  
                                           aten::matmul         1.36%      34.000us        18.60%     465.000us      77.500us       0.000us         0.00%     501.000us      83.500us           0 b           0 b      13.47 Mb      14.00 Kb             6            --  
                                               aten::mm        15.44%     386.000us        17.72%     443.000us      73.833us     505.000us        33.01%     505.000us      84.167us           0 b           0 b      13.47 Mb      13.47 Mb             6   4040294.400  
cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFla...         0.32%       8.000us         0.32%       8.000us       0.667us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            12            --  
                                       cudaLaunchKernel        10.92%     273.000us        10.92%     273.000us       2.758us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            99            --  
                                              aten::mul         2.96%      74.000us         4.12%     103.000us      10.300us     273.000us        17.84%     273.000us      27.300us           0 b           0 b      46.19 Mb      46.19 Mb            10      4763.072  
                                             aten::add_         0.44%      11.000us         0.64%      16.000us       8.000us      25.000us         1.63%      25.000us      12.500us           0 b           0 b           0 b           0 b             2            --  
                                 ampere_sgemm_128x32_nn         0.00%       0.000us         0.00%       0.000us       0.000us      24.000us         1.57%      24.000us      12.000us           0 b           0 b           0 b           0 b             2            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.500ms
Self CUDA time total: 1.530ms

test acc:  0.9408866995073891


pre-train
train memory : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::empty         0.86%      17.888ms         0.86%      17.888ms       1.566us       0.000us         0.00%       0.000us       0.000us     163.26 Mb     163.26 Mb       3.75 Gb       3.75 Gb         11423            --  
                                          aten::nonzero         2.46%      51.061ms        28.82%     598.745ms     272.157us      11.351ms         1.21%      42.119ms      19.145us       8.67 Mb       8.18 Mb      69.44 Mb      11.26 Mb          2200            --  
                                              aten::mul         1.41%      29.243ms         1.98%      41.086ms       7.074us     197.310ms        20.95%     206.135ms      35.492us       3.01 Mb       3.01 Mb      32.17 Gb      32.15 Gb          5808      5644.785  
                                        aten::remainder         0.14%       2.975ms         0.14%       2.975ms      14.728us       0.000us         0.00%       0.000us       0.000us       2.92 Mb       2.92 Mb           0 b           0 b           202            --  
                                      aten::as_strided_         0.02%     416.000us         0.02%     416.000us       0.693us       0.000us         0.00%       0.000us       0.000us     503.36 Kb     503.36 Kb           0 b           0 b           600            --  
                                    aten::empty_strided         0.61%      12.747ms         0.62%      12.888ms       1.493us       0.000us         0.00%      32.000us       0.004us       4.44 Kb       4.44 Kb       5.35 Gb       5.35 Gb          8632            --  
                                    aten::_foreach_add_         0.14%       2.918ms         0.67%      13.850ms      34.625us       5.160ms         0.55%       5.340ms      13.350us         536 b       1.30 Kb           0 b           0 b           400            --  
                                              aten::div         0.54%      11.293ms         0.75%      15.575ms       6.471us       9.475ms         1.01%      13.251ms       5.505us         992 b         992 b       1.91 Gb       1.87 Gb          2407            --  
                                             aten::div_         0.07%       1.406ms         0.10%       2.041ms       9.627us     401.000us         0.04%     929.000us       4.382us         616 b         616 b           0 b           0 b           212            --  
                                          aten::dropout         0.03%     641.000us         0.41%       8.445ms       7.037us       0.000us         0.00%      19.388ms      16.157us           0 b           0 b       3.10 Gb    -523.66 Mb          1200            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.078s
Self CUDA time total: 941.684ms

test acc(real data):  0.95
test acc:  0.8769987699876999
value of cmd:  0.30460065603256226


fine-tuning
train(fine-tuning) : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                          aten::nonzero         1.49%      19.875ms        20.38%     271.401ms     271.401us       3.409ms         0.59%      14.815ms      14.815us       1.86 Mb       1.80 Mb      32.28 Mb       3.55 Mb          1000            --  
                                              aten::mul         1.56%      20.781ms         2.22%      29.613ms       6.415us     143.587ms        24.72%     150.067ms      32.510us     687.27 Kb     687.27 Kb      24.18 Gb      24.18 Gb          4616      4986.776  
                                        aten::remainder         0.12%       1.550ms         0.12%       1.550ms       7.452us       0.000us         0.00%       0.000us       0.000us     662.12 Kb     662.12 Kb           0 b           0 b           208            --  
                                      aten::as_strided_         0.03%     410.000us         0.03%     410.000us       0.683us       0.000us         0.00%       0.000us       0.000us      63.59 Kb      63.59 Kb           0 b           0 b           600            --  
                                               [memory]         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us       3.12 Kb       3.12 Kb     -13.50 Gb     -13.50 Gb         11314            --  
                                    aten::empty_strided         0.49%       6.564ms         0.50%       6.713ms       1.523us       0.000us         0.00%       0.000us       0.000us       2.21 Kb       2.21 Kb       3.49 Gb       3.49 Gb          4408            --  
                                              aten::div         0.70%       9.271ms         0.96%      12.738ms       6.340us       8.726ms         1.50%      11.501ms       5.725us       1.01 Kb       1.01 Kb       1.73 Gb       1.68 Gb          2009            --  
                                             aten::div_         0.09%       1.223ms         0.14%       1.824ms       8.645us     410.000us         0.07%     665.000us       3.152us         648 b         648 b           0 b           0 b           211            --  
                                            aten::empty         0.74%       9.886ms         0.75%       9.969ms       1.423us       0.000us         0.00%       8.000us       0.001us           4 b           4 b       2.40 Gb       2.40 Gb          7004            --  
                                          aten::dropout         0.04%     536.000us         0.44%       5.803ms       9.672us       0.000us         0.00%      18.972ms      31.620us           0 b           0 b       3.03 Gb    -605.85 Mb           600            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.332s
Self CUDA time total: 580.918ms

test(fine-tuning) : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total KFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                               aten::to         0.76%      19.000us         2.05%      51.000us      10.200us       0.000us         0.00%       0.000us       0.000us      21.16 Kb      21.16 Kb      10.50 Kb       3.50 Kb             5            --  
                                         aten::_to_copy         0.44%      11.000us         1.89%      47.000us      11.750us       0.000us         0.00%       3.000us       0.750us      21.16 Kb      21.16 Kb      10.50 Kb       3.50 Kb             4            --  
                                          aten::nonzero         4.83%     120.000us        38.11%     947.000us     157.833us      32.000us         2.11%      32.000us       5.333us       6.34 Kb       6.34 Kb     174.00 Kb      83.50 Kb             6            --  
                                               [memory]         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us           8 b           8 b    -101.31 Mb    -101.31 Mb            87            --  
                                           aten::matmul         0.85%      21.000us        18.11%     450.000us      75.000us       0.000us         0.00%     505.000us      84.167us           0 b           0 b      13.47 Mb           0 b             6            --  
                                               aten::mm        14.85%     369.000us        17.26%     429.000us      71.500us     505.000us        33.33%     505.000us      84.167us           0 b           0 b      13.47 Mb      13.47 Mb             6   4040294.400  
cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFla...         0.28%       7.000us         0.28%       7.000us       0.583us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            12            --  
                                       cudaLaunchKernel        10.87%     270.000us        10.87%     270.000us       2.727us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            99            --  
                                             aten::add_         0.48%      12.000us         0.68%      17.000us       8.500us      25.000us         1.65%      25.000us      12.500us           0 b           0 b           0 b           0 b             2            --  
                                 ampere_sgemm_128x32_nn         0.00%       0.000us         0.00%       0.000us       0.000us      24.000us         1.58%      24.000us      12.000us           0 b           0 b           0 b           0 b             2            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.485ms
Self CUDA time total: 1.515ms

test acc:  0.916256157635468


pre-train
train memory : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::empty         0.79%      17.167ms         0.79%      17.167ms       1.503us       0.000us         0.00%       0.000us       0.000us     185.67 Mb     185.67 Mb       3.75 Gb       3.75 Gb         11425            --  
                                          aten::nonzero         2.37%      51.436ms        28.98%     629.739ms     286.245us      11.352ms         1.18%      42.349ms      19.250us       8.67 Mb       8.37 Mb      69.46 Mb       9.19 Mb          2200            --  
                                              aten::mul         1.42%      30.924ms         2.04%      44.239ms       7.613us     198.086ms        20.59%     207.413ms      35.693us       3.05 Mb       3.05 Mb      32.19 Gb      32.19 Gb          5811      5644.790  
                                        aten::remainder         0.14%       3.055ms         0.14%       3.055ms      15.049us       0.000us         0.00%       0.000us       0.000us       2.94 Mb       2.94 Mb           0 b           0 b           203            --  
                                      aten::as_strided_         0.02%     424.000us         0.02%     424.000us       0.707us       0.000us         0.00%       0.000us       0.000us     310.90 Kb     310.90 Kb           0 b           0 b           600            --  
                                    aten::empty_strided         0.61%      13.349ms         0.62%      13.486ms       1.558us       0.000us         0.00%      35.000us       0.004us       4.37 Kb       4.37 Kb       5.58 Gb       5.58 Gb          8656            --  
                                    aten::_foreach_add_         0.13%       2.749ms         0.65%      14.172ms      35.430us       5.042ms         0.52%       5.240ms      13.100us         504 b       1.70 Kb           0 b           0 b           400            --  
                                              aten::div         0.54%      11.709ms         0.75%      16.205ms       6.735us       9.573ms         0.99%      12.513ms       5.201us         904 b         904 b       1.91 Gb       1.89 Gb          2406            --  
                                             aten::div_         0.07%       1.484ms         0.10%       2.142ms      10.104us     404.000us         0.04%     500.000us       2.358us         512 b         512 b           0 b           0 b           212            --  
                                          aten::dropout         0.03%     614.000us         0.36%       7.717ms       6.431us       0.000us         0.00%      19.377ms      16.148us           0 b           0 b       3.06 Gb    -571.69 Mb          1200            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.173s
Self CUDA time total: 962.254ms

test acc(real data):  0.952
test acc:  0.8733087330873309
value of cmd:  0.38159462809562683


fine-tuning
train(fine-tuning) : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                          aten::nonzero         1.54%      20.825ms        19.58%     264.401ms     264.401us       3.498ms         0.60%      14.931ms      14.931us       1.86 Mb       1.80 Mb      32.28 Mb       1.92 Mb          1000            --  
                                              aten::mul         1.61%      21.702ms         2.25%      30.376ms       6.583us     143.985ms        24.63%     150.572ms      32.634us     681.02 Kb     681.02 Kb      24.19 Gb      24.18 Gb          4614      4986.775  
                                        aten::remainder         0.12%       1.633ms         0.12%       1.633ms       7.966us       0.000us         0.00%       0.000us       0.000us     652.44 Kb     652.44 Kb           0 b           0 b           205            --  
                                      aten::as_strided_         0.03%     415.000us         0.03%     415.000us       0.692us       0.000us         0.00%       0.000us       0.000us      66.77 Kb      66.77 Kb           0 b           0 b           600            --  
                                               [memory]         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us       3.08 Kb       3.08 Kb     -13.60 Gb     -13.60 Gb         11372            --  
                                    aten::empty_strided         0.53%       7.151ms         0.54%       7.307ms       1.658us       0.000us         0.00%       0.000us       0.000us       2.27 Kb       2.27 Kb       3.66 Gb       3.66 Gb          4408            --  
                                              aten::div         0.72%       9.668ms         0.98%      13.258ms       6.593us       8.782ms         1.50%      11.651ms       5.794us        1008 b        1008 b       1.73 Gb       1.69 Gb          2011            --  
                                             aten::div_         0.10%       1.365ms         0.15%       2.008ms       9.211us     401.000us         0.07%     654.000us       3.000us         560 b         560 b           0 b           0 b           218            --  
                                            aten::empty         0.76%      10.262ms         0.77%      10.336ms       1.476us       0.000us         0.00%       8.000us       0.001us           8 b           8 b       2.47 Gb       2.47 Gb          7004            --  
                                          aten::dropout         0.04%     595.000us         0.44%       5.968ms       9.947us       0.000us         0.00%      19.015ms      31.692us           0 b           0 b       3.00 Gb    -636.15 Mb           600            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.351s
Self CUDA time total: 584.590ms

test(fine-tuning) : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total KFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::copy_         0.95%      24.000us         1.95%      49.000us       8.167us       7.000us         0.46%       7.000us       1.167us      21.16 Kb      21.16 Kb           0 b           0 b             6            --  
                                          aten::nonzero         4.89%     123.000us        37.48%     943.000us     157.167us      32.000us         2.11%      32.000us       5.333us       6.34 Kb       6.34 Kb     175.50 Kb      93.00 Kb             6            --  
                                               [memory]         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us           8 b           8 b    -106.67 Mb    -106.67 Mb            87            --  
                                           aten::matmul         1.23%      31.000us        17.73%     446.000us      74.333us       0.000us         0.00%     502.000us      83.667us           0 b           0 b      13.47 Mb      14.00 Kb             6            --  
                                               aten::mm        14.47%     364.000us        16.89%     425.000us      70.833us     506.000us        33.31%     506.000us      84.333us           0 b           0 b      13.47 Mb      13.47 Mb             6   4040294.400  
cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFla...         0.36%       9.000us         0.36%       9.000us       0.750us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            12            --  
                                       cudaLaunchKernel        10.65%     268.000us        10.65%     268.000us       2.707us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            99            --  
                                             aten::add_         0.48%      12.000us         0.68%      17.000us       8.500us      25.000us         1.65%      25.000us      12.500us           0 b           0 b           0 b           0 b             2            --  
                                 ampere_sgemm_128x32_nn         0.00%       0.000us         0.00%       0.000us       0.000us      24.000us         1.58%      24.000us      12.000us           0 b           0 b           0 b           0 b             2            --  
                aten::_has_compatible_shallow_copy_type         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             4            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.516ms
Self CUDA time total: 1.519ms

test acc:  0.9285714285714286


pre-train
train memory : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::empty         0.78%      16.777ms         0.78%      16.777ms       1.471us       0.000us         0.00%       0.000us       0.000us     174.32 Mb     174.32 Mb       3.73 Gb       3.73 Gb         11407            --  
                                          aten::nonzero         2.43%      52.422ms        29.78%     641.291ms     291.496us      11.307ms         1.18%      46.578ms      21.172us       8.67 Mb       8.37 Mb      69.45 Mb      10.27 Mb          2200            --  
                                              aten::mul         1.40%      30.162ms         1.98%      42.743ms       7.342us     201.835ms        21.02%     213.269ms      36.632us       3.21 Mb       3.21 Mb      32.18 Gb      10.63 Gb          5822      5644.811  
                                        aten::remainder         0.14%       3.013ms         0.14%       3.013ms      14.916us       0.000us         0.00%       0.000us       0.000us       2.92 Mb       2.92 Mb           0 b           0 b           202            --  
                                      aten::as_strided_         0.02%     422.000us         0.02%     422.000us       0.703us       0.000us         0.00%       0.000us       0.000us     310.90 Kb     310.90 Kb           0 b           0 b           600            --  
                                    aten::empty_strided         0.60%      12.935ms         0.61%      13.085ms       1.516us       0.000us         0.00%      30.000us       0.003us       4.26 Kb       4.26 Kb       5.52 Gb       5.52 Gb          8632            --  
                                              aten::div         0.53%      11.425ms         0.74%      15.914ms       6.628us       9.385ms         0.98%      12.202ms       5.082us         880 b         880 b       1.90 Gb     573.50 Mb          2401            --  
                                    aten::_foreach_add_         0.13%       2.755ms         0.64%      13.875ms      34.688us       5.117ms         0.53%       5.426ms      13.565us         532 b         824 b           0 b           0 b           400            --  
                                             aten::div_         0.07%       1.500ms         0.10%       2.195ms      10.403us     411.000us         0.04%     486.000us       2.303us         624 b         624 b           0 b           0 b           211            --  
                                          aten::dropout         0.05%       1.103ms         0.41%       8.748ms       7.290us       0.000us         0.00%      19.208ms      16.007us           0 b           0 b       3.08 Gb    -553.96 Mb          1200            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.154s
Self CUDA time total: 960.230ms

test acc(real data):  0.952
test acc:  0.8782287822878229
value of cmd:  0.6374408006668091


fine-tuning
train(fine-tuning) : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                          aten::nonzero         1.43%      20.206ms        20.62%     291.327ms     291.327us       3.499ms         0.59%      14.956ms      14.956us       1.86 Mb       1.80 Mb      32.27 Mb     808.50 Kb          1000            --  
                                              aten::mul         1.51%      21.384ms         2.13%      30.151ms       6.545us     147.035ms        24.99%     153.989ms      33.425us     658.72 Kb     658.72 Kb      24.17 Gb      21.13 Gb          4607      4986.772  
                                        aten::remainder         0.12%       1.679ms         0.12%       1.679ms       8.230us       0.000us         0.00%       0.000us       0.000us     649.27 Kb     649.27 Kb           0 b           0 b           204            --  
                                      aten::as_strided_         0.03%     403.000us         0.03%     403.000us       0.672us       0.000us         0.00%       0.000us       0.000us      66.77 Kb      66.77 Kb           0 b           0 b           600            --  
                                               [memory]         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us       3.22 Kb       3.22 Kb     -13.72 Gb     -13.72 Gb         11358            --  
                                    aten::empty_strided         0.50%       7.113ms         0.51%       7.260ms       1.647us       0.000us         0.00%       0.000us       0.000us       2.21 Kb       2.21 Kb       3.66 Gb       3.66 Gb          4408            --  
                                              aten::div         0.69%       9.791ms         0.96%      13.552ms       6.752us       8.753ms         1.49%      11.631ms       5.795us       1.04 Kb       1.04 Kb       1.73 Gb       1.57 Gb          2007            --  
                                             aten::div_         0.09%       1.327ms         0.14%       1.953ms       9.126us     402.000us         0.07%     657.000us       3.070us         752 b         744 b           0 b           0 b           214            --  
                                    aten::_foreach_add_         0.15%       2.072ms         0.67%       9.407ms      23.517us       1.035ms         0.18%       1.288ms       3.220us         664 b         116 b           0 b           0 b           400            --  
                                            aten::empty         0.73%      10.306ms         0.73%      10.380ms       1.482us       0.000us         0.00%       8.000us       0.001us           8 b           8 b       2.46 Gb       2.46 Gb          7004            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.413s
Self CUDA time total: 588.261ms

test(fine-tuning) : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total KFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                    aten::empty_strided         0.32%       8.000us         0.32%       8.000us       2.000us       0.000us         0.00%       0.000us       0.000us      21.16 Kb      21.16 Kb      10.50 Kb      10.50 Kb             4            --  
                                          aten::nonzero         4.80%     119.000us        37.45%     928.000us     154.667us      32.000us         2.09%      32.000us       5.333us       6.34 Kb       6.34 Kb     173.00 Kb           0 b             6            --  
                                           aten::matmul         1.82%      45.000us        18.56%     460.000us      76.667us       0.000us         0.00%     498.000us      83.000us           0 b           0 b      13.47 Mb     592.50 Kb             6            --  
                                               aten::mm        15.33%     380.000us        17.72%     439.000us      73.167us     507.000us        33.18%     507.000us      84.500us           0 b           0 b      13.47 Mb      13.47 Mb             6   4040294.400  
cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFla...         0.32%       8.000us         0.32%       8.000us       0.667us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            12            --  
                                       cudaLaunchKernel        10.94%     271.000us        10.94%     271.000us       2.737us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            99            --  
                                              aten::mul         2.95%      73.000us         4.08%     101.000us      10.100us     261.000us        17.08%     261.000us      26.100us           0 b           0 b      46.19 Mb      46.19 Mb            10      4763.072  
                                             aten::add_         0.44%      11.000us         0.61%      15.000us       7.500us      25.000us         1.64%      25.000us      12.500us           0 b           0 b           0 b           0 b             2            --  
                aten::_has_compatible_shallow_copy_type         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             4            --  
                                 ampere_sgemm_128x32_nn         0.00%       0.000us         0.00%       0.000us       0.000us      25.000us         1.64%      25.000us      12.500us           0 b           0 b           0 b           0 b             2            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.478ms
Self CUDA time total: 1.528ms

test acc:  0.9507389162561576


pre-train
train memory : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                            aten::empty         0.76%      16.298ms         0.76%      16.298ms       1.433us       0.000us         0.00%       0.000us       0.000us     168.75 Mb     168.75 Mb       3.68 Gb       3.68 Gb         11370            --  
                                          aten::nonzero         2.36%      50.479ms        29.81%     636.385ms     289.266us      11.256ms         1.18%      44.279ms      20.127us       8.67 Mb       8.39 Mb      69.47 Mb      10.56 Mb          2200            --  
                                              aten::mul         1.36%      29.074ms         1.91%      40.883ms       7.034us     202.507ms        21.27%     211.943ms      36.466us       3.07 Mb       3.07 Mb      32.17 Gb      22.25 Gb          5812      5644.792  
                                        aten::remainder         0.14%       2.929ms         0.14%       2.929ms      14.572us       0.000us         0.00%       0.000us       0.000us       2.91 Mb       2.91 Mb           0 b           0 b           201            --  
                                      aten::as_strided_         0.02%     423.000us         0.02%     423.000us       0.705us       0.000us         0.00%       0.000us       0.000us     296.09 Kb     296.09 Kb           0 b           0 b           600            --  
                                    aten::empty_strided         0.59%      12.668ms         0.60%      12.815ms       1.493us       0.000us         0.00%      31.000us       0.004us       4.41 Kb       4.41 Kb       5.49 Gb       5.49 Gb          8584            --  
                                              aten::div         0.52%      11.171ms         0.74%      15.747ms       6.548us       9.467ms         0.99%      13.469ms       5.600us         872 b         872 b       1.93 Gb       1.37 Gb          2405            --  
                                    aten::_foreach_add_         0.13%       2.831ms         0.65%      13.779ms      34.447us       5.060ms         0.53%       5.167ms      12.918us         436 b         748 b           0 b           0 b           400            --  
                                             aten::div_         0.07%       1.397ms         0.10%       2.053ms       9.730us     401.000us         0.04%     592.000us       2.806us         600 b         600 b           0 b           0 b           211            --  
                                          aten::dropout         0.04%     870.000us         0.42%       8.877ms       7.397us       0.000us         0.00%      18.984ms      15.820us           0 b           0 b       3.11 Gb    -517.04 Mb          1200            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.135s
Self CUDA time total: 952.067ms

test acc(real data):  0.947
test acc:  0.8720787207872078
value of cmd:  0.4501134753227234


fine-tuning
train(fine-tuning) : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total MFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                          aten::nonzero         1.45%      20.585ms        20.32%     287.533ms     287.533us       3.464ms         0.59%      16.124ms      16.124us       1.86 Mb       1.82 Mb      32.27 Mb       1.47 Mb          1000            --  
                                              aten::mul         1.51%      21.358ms         2.14%      30.226ms       6.558us     146.599ms        24.86%     153.154ms      33.229us     665.16 Kb     665.16 Kb      24.18 Gb      22.73 Gb          4609      4986.773  
                                        aten::remainder         0.12%       1.719ms         0.12%       1.719ms       8.385us       0.000us         0.00%       0.000us       0.000us     652.41 Kb     652.41 Kb           0 b           0 b           205            --  
                                      aten::as_strided_         0.03%     401.000us         0.03%     401.000us       0.668us       0.000us         0.00%       0.000us       0.000us      47.70 Kb      47.70 Kb           0 b           0 b           600            --  
                                               [memory]         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us       3.09 Kb       3.09 Kb     -13.70 Gb     -13.70 Gb         11419            --  
                                    aten::empty_strided         0.50%       7.042ms         0.51%       7.184ms       1.630us       0.000us         0.00%       0.000us       0.000us       2.27 Kb       2.27 Kb       3.59 Gb       3.59 Gb          4408            --  
                                              aten::div         0.67%       9.525ms         0.92%      13.056ms       6.508us       8.740ms         1.48%      12.641ms       6.302us       1.02 Kb       1.02 Kb       1.72 Gb       1.60 Gb          2006            --  
                                             aten::div_         0.09%       1.309ms         0.14%       1.960ms       9.378us     415.000us         0.07%     672.000us       3.215us         608 b         608 b           0 b           0 b           209            --  
                                    aten::_foreach_add_         0.15%       2.059ms         0.66%       9.397ms      23.492us       1.040ms         0.18%       1.311ms       3.277us         656 b          32 b           0 b           0 b           400            --  
                                            aten::empty         0.72%      10.153ms         0.72%      10.226ms       1.460us       0.000us         0.00%       8.000us       0.001us           8 b           8 b       2.42 Gb       2.42 Gb          7004            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 1.415s
Self CUDA time total: 589.609ms

test(fine-tuning) : 
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg       CPU Mem  Self CPU Mem      CUDA Mem  Self CUDA Mem    # of Calls  Total KFLOPs  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
                                               aten::to         0.45%      11.000us         2.13%      52.000us      10.400us       0.000us         0.00%       3.000us       0.600us      21.16 Kb      21.16 Kb      10.50 Kb           0 b             5            --  
                                    aten::empty_strided         0.33%       8.000us         0.33%       8.000us       2.000us       0.000us         0.00%       0.000us       0.000us      21.16 Kb      21.16 Kb      10.50 Kb      10.50 Kb             4            --  
                                          aten::nonzero         5.00%     122.000us        37.76%     922.000us     153.667us      33.000us         2.20%      33.000us       5.500us       6.34 Kb       6.34 Kb     176.00 Kb       7.00 Kb             6            --  
                                           aten::matmul         0.82%      20.000us        18.02%     440.000us      73.333us       0.000us         0.00%     503.000us      83.833us           0 b           0 b      13.47 Mb           0 b             6            --  
                                               aten::mm        14.99%     366.000us        17.20%     420.000us      70.000us     503.000us        33.56%     503.000us      83.833us           0 b           0 b      13.47 Mb      13.47 Mb             6   4040294.400  
cudaOccupancyMaxActiveBlocksPerMultiprocessorWithFla...         0.29%       7.000us         0.29%       7.000us       0.583us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            12            --  
                                       cudaLaunchKernel        10.36%     253.000us        10.36%     253.000us       2.556us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b            99            --  
                                               [memory]         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b    -106.51 Mb    -106.51 Mb            88            --  
                                             aten::add_         0.49%      12.000us         0.70%      17.000us       8.500us      25.000us         1.67%      25.000us      12.500us           0 b           0 b           0 b           0 b             2            --  
                aten::_has_compatible_shallow_copy_type         0.00%       0.000us         0.00%       0.000us       0.000us       0.000us         0.00%       0.000us       0.000us           0 b           0 b           0 b           0 b             4            --  
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  
Self CPU time total: 2.442ms
Self CUDA time total: 1.499ms

test acc:  0.9236453201970444


